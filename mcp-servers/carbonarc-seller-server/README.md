# CarbonArc Seller MCP Server

This MCP Server has four tools -

1. create-account-and-login: Having an account with CarbonArc is mandatory to access its tools. This tool creates account for current buyer agent using the KYA token generated by Skyfire and an agent generated new secure regex password that must contain minimum of 8,  maximum of 12 alphanumeric characters including atleast 1 uppercase character, 1 numeric character and 1 special character. On successful account creation, access token is returned.
2. search-dataset: Access token is mandatory to access this tool. This tool returns the list of datasets matching the input prompt. Each dataset has dataset_id which could be further used in other tools.
3. get-pricing: Access token is mandatory to access this tool. This tool gets pricing for the dataset_id provided.
4. download-dataset: Access token is mandatory to access this tool. Payment should. already be executed and JWT PAY token generated by Skyfire is required. This tool returns the dataset url for the selected dataset_id.

## Getting Started

- Set up an Auth0 account: 
Auth0 is the default CIAM being used in this demo.

Steps to be followed for setting up Auth0:
1. Visit the [Auth0 Dashboard](https://manage.auth0.com/dashboard/)
2. Create a new tenant
3. Follow the [Auth0 official documentation for creating a new custom token exchange profile](https://auth0.com/docs/authenticate/custom-token-exchange)
4. [Sample code for creating Auth0 Action](https://github.com/skyfire-xyz/skyfire-solutions-okta-demo/tree/main/auth0/sample-action-code.ts).
   
## Installation

1.  Install dependencies:
    ```bash
    npm install
    ```
2. Follow the [Skyfire Platform Setup Guide](https://docs.skyfire.xyz/docs/introduction) to create seller account and seller services.
3. Use the Auth0 Client ID, Client Secret, Domain etc details from Settings tab of your newly created Application in env variables in [CarbonArc MCP Server](https://github.com/skyfire-xyz/skyfire-solutions-okta-demo/tree/main/mcp-servers/carbonarc-seller-server).
4. Set up environment variables:
    Create a `.dev.vars` file in the root directory. You can copy `.dev.vars.example` if one exists, or add the necessary variables manually.

    ```
    # .dev.vars
    CARBONARC_SELLER_SERVICE_ID=<your_seller_service_id>
    JWKS_URL=https://api.skyfire.xyz/.well-known/jwks.json
    SKYFIRE_API_KEY=<your_carbonarc_seller_api_key>
    JWT_ISSUER=https://app.skyfire.xyz
    SKYFIRE_API_BASE_URL=https://api.skyfire.xyz
    AUTH0_AUDIENCE=<your_auth0_api_audience>
    AUTH0_CLIENT_ID=<your_auth0_application_client_id>
    AUTH0_CLIENT_SECRET=<your_auth0_application_client_secret>
    AUTH0_GRANT_TYPE=urn:ietf:params:oauth:grant-type:token-exchange
    AUTH0_SUBJECT_TOKEN_TYPE=<your_custom_token_exchange_profile_subject_token_type>
    AUTH0_URL=<your_auth0_application_domain>/oauth/token
    ```

## Run the development server:

```bash
npm run dev
```

The MCP server will run on [http://localhost:8789/sse](http://localhost:8789/sse).
